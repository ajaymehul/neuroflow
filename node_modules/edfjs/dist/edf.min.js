!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n;n="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,n.edfjs=e()}}(function(){return function(){function e(n,r,a){function i(l,s){if(!r[l]){if(!n[l]){var u="function"==typeof require&&require;if(!s&&u)return u(l,!0);if(t)return t(l,!0);var o=new Error("Cannot find module '"+l+"'");throw o.code="MODULE_NOT_FOUND",o}var m=r[l]={exports:{}};n[l][0].call(m.exports,function(e){var r=n[l][1][e];return i(r||e)},m,m.exports,e,n,r,a)}return r[l].exports}for(var t="function"==typeof require&&require,l=0;l<a.length;l++)i(a[l]);return i}return e}()({1:[function(e,n,r){"use strict";var a=function(e){return String(e).trim()},i=function(e,n,r){var a=new Uint8Array(e,n,r-n);return String.fromCharCode.apply(null,a)},t=function(e,n){if(!e)throw"Assertion Error: "+n},l=function(e,n,r){r=r||"20";var a,i,t,l,s,u,o;if(e.includes("-")?(e=e.split("-"),a=e[0],i=e[1],t=e[2]):e.includes("/")?(e=e.split("/"),a=e[2],i=e[0],t=e[1]):e.includes(".")&&(e=e.split("."),a=e[2],i=e[1],t=e[0]),i=+i-1,2==a.length&&(a=r+a),n=n.replace(/\./g,":").split(":"),l=n[0],s=n[1],u=n[2],o=n[3],o&&3!=o.length){for(var m=0;m<3-o.length;m++)o+="0";o=o.substring(0,4)}return new Date(Date.UTC(a,i,t,l,s,u,o||0))},s=function(e){e=e||{},e.fields={label:[a,16],channel_type:[a,80],physical_dimension:[a,8],physical_minimum:[Number,8],physical_maximum:[Number,8],digital_minimum:[Number,8],digital_maximum:[Number,8],prefiltering:[a,80],num_samples_per_record:[Number,8],reserved:[a,32]};var n=null,r=null,i=function(e){return n*(e+r)},t=function(a,i){return null==e.num_samples_per_record?(console.log("Error: allocate_blob called on uninitialized channel."),null):(e.blob=new Float32Array(a*e.num_samples_per_record),n=(this.physical_maximum-this.physical_minimum)/(this.digital_maximum-this.digital_minimum),r=this.physical_maximum/n-this.digital_maximum,void(e.sampling_rate=e.num_samples_per_record/i))},l=function(n,r){for(var a=n*e.num_samples_per_record,t=0;t<e.num_samples_per_record;t++)e.blob[a+t]=i(r[t])},s=function(n,r,a){a=a||r*e.sampling_rate;var i=n*e.sampling_rate;return e.blob.slice(i,i+a)};return e.set_record=l,e.get_physical_samples=s,e.digital2physical=i,e.init=t,e},u=function(e){e=e||{},e.fields={version:[a,8],pid:[a,80],rid:[a,80],startdate:[a,8],starttime:[a,8],num_header_bytes:[Number,8],reserved:[a,44],num_records:[Number,8],record_duration:[Number,8],num_channels:[Number,4]};var n=256,r=2,u=function(n){var r=0;for(var a in e.fields){var i=e.fields[a][0],t=r+e.fields[a][1];e[a]=i(n.substring(r,t)),r=t}e.startdatetime=l(e.startdate,e.starttime)},o=function(n){e.channels=[];for(var r=0;r<e.num_channels;r++)e.channels.push(s());var a=0,i=e.channels[0].fields;for(var t in i)for(var l=i[t][0],u=i[t][1],r=0;r<e.num_channels;r++){var o=a+u;e.channels[r][t]=l(n.substring(a,o)),a=o}e.channel_by_label={};for(var r in e.channels){var m=e.channels[r];e.channel_by_label[m.label]=m}},m=function(n){for(var r=0,a=0;a<e.num_channels;a++)r+=e.channels[a].num_samples_per_record;var i=r*e.num_records,l=(n.byteLength-e.num_header_bytes)/2;return e.duration=e.record_duration*l/r,t(l==i,"Header implies "+i+" samples; "+l+" found."),l},c=function(n){for(var a=[0],i=0;i<e.num_channels;i++)a.push(a[i]+e.channels[i].num_samples_per_record);var t=a[e.channels.length];try{var l=m(n)}catch(s){console.error(s);var l=(n.byteLength-e.num_header_bytes)/r}for(var u=new Int16Array(n,e.num_header_bytes,l),i=0;i<e.num_channels;i++)e.channels[i].init(e.num_records,e.record_duration);for(var o=0;o<e.num_records;o++)for(var i=0;i<e.num_channels;i++)e.channels[i].set_record(o,u.slice(o*t+a[i],o*t+a[i+1]));e.sampling_rate={};for(var c in e.channel_by_label){var _=e.channel_by_label[c];e.sampling_rate[c]=_.sampling_rate}},_=function(r,a){a=a||!1;var t=i(r,0,n);return u(t),0==e.num_channels?null:(t=i(r,n,e.num_header_bytes),o(t),m(r),void(a||c(r)))},f=function(n,r){return r=r||!1,new Promise(function(a,i){var t=new FileReader;e.filename=n.name,t.onload=function(n){_(n.target.result,r),a(e)},t.readAsArrayBuffer(n)})},d=function(n,r,a,i){return new Promise(function(t,l){var s={};for(var u in a){var o=a[u];s[o]=e.channel_by_label[o].get_physical_samples(n,r,i)}t(s)})},h=function(n){return e.startdatetime.getTime()+n},p=function(e){return new Date(h(e))};return e.from_file=f,e.read_buffer=_,e.relative_date=p,e.get_physical_samples=d,e.read_header_from_string=u,e};r.string_from_buffer=i,r.Channel=s,r.EDF=u},{}]},{},[1])(1)});
